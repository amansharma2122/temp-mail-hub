# API Directory

RewriteEngine On

# Handle CORS preflight
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ - [R=204,L]

# Route all requests through router.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ router.php [L,QSA]

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "DENY"
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Deny access to sensitive files
<FilesMatch "\.(php|ini|log)$">
    <IfModule mod_authz_core.c>
        # Apache 2.4
        Require all granted
    </IfModule>
</FilesMatch>

# Specifically deny config.php direct access
<Files "config.php">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</Files>
